###统一过一遍事件订阅，要有效率，只撸需求
邮件：先问问组长可不可以发

关于wcloud长期运行响应慢的问题
上周五和程湘讨论并和陈青测试，目前可以确认的问题：

###初步问题定位：
第一是事件订阅和发布严重被滥用；管道回收机制不完善，事件循环不合理
    尤其是涉及dom更新的和ajax请求的事件发布，严重影响性能
    订阅被滥用的消息的handler中再次发布消息，可导致消息指数级增长
    事件循环不合理，每次根据优先级排序事件handler

第二是在查的共享内存的问题


问题1：消息发送太灵活，没有拘束，管道底层做好约束，上层注意使用规范

问题2：

###初步处理方案：
1.管道业务梳理
    严重关注事件生命周期
        关注何时开始监听，何时停止监听，关注发送的事件的作用域
    梳理事件业务场景，根据使用场景，添加更多单元测试用例

2.事件管道
    整理事件作用域，事件纳入到生命周期管理
    合理采用jquery域事件循环
    建议暂时去掉优先级和排序行为，后期以数据结构优先队列实现优先级事件
    消息管道和事件管道可统一

3.管道使用规范
    写代码时，事件订阅集中到一处
    监听自己的业务逻辑改为方法调用

###管道重写初步实现：
以下内容已经重写消息管道并加入单元测试：
1.close.panel|once这种只可能发生一次的事件做成once的
2.active.panel在active生命周期内的事件，做成|recycle域内可回收事件，生命周期结束要调用管道回收
    找出具有可回收特征的这些事件，比如checkin、checkout、save等操作，定义成可回收事件
    close.panel|once
    active.panel|recycle
    active.panel|always
3.整理jquery域事件Api，并且可以不依赖dom，统一对外接口